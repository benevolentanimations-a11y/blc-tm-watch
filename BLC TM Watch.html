<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trademark Watch Platform</title>
    <style>
        :root {
            --color-bg-primary: #0f172a;
            --color-bg-secondary: #1e293b;
            --color-bg-card: #334155;
            --color-text-primary: #f1f5f9;
            --color-text-secondary: #cbd5e1;
            --color-accent: #38bdf8;
            --color-accent-hover: #0ea5e9;
            --color-success: #22c55e;
            --color-warning: #f59e0b;
            --color-danger: #ef4444;
            --color-border: #475569;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--color-bg-primary);
            color: var(--color-text-primary);
            line-height: 1.6;
        }

        .header {
            background: var(--color-bg-secondary);
            padding: 1.5rem 2rem;
            border-bottom: 1px solid var(--color-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            font-size: 1.5rem;
            color: var(--color-accent);
        }

        .nav-tabs {
            display: flex;
            gap: 1rem;
        }

        .nav-tab {
            padding: 0.5rem 1rem;
            background: transparent;
            border: 1px solid var(--color-border);
            color: var(--color-text-secondary);
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.2s;
        }

        .nav-tab:hover {
            background: var(--color-bg-card);
            color: var(--color-text-primary);
        }

        .nav-tab.active {
            background: var(--color-accent);
            color: var(--color-bg-primary);
            border-color: var(--color-accent);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--color-bg-secondary);
            padding: 1.5rem;
            border-radius: 8px;
            border: 1px solid var(--color-border);
        }

        .stat-label {
            color: var(--color-text-secondary);
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 600;
            color: var(--color-accent);
        }

        .card {
            background: var(--color-bg-secondary);
            border: 1px solid var(--color-border);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
        }

        .btn {
            padding: 0.625rem 1.25rem;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.2s;
        }

        .btn-primary {
            background: var(--color-accent);
            color: var(--color-bg-primary);
        }

        .btn-primary:hover {
            background: var(--color-accent-hover);
        }

        .btn-secondary {
            background: var(--color-bg-card);
            color: var(--color-text-primary);
            border: 1px solid var(--color-border);
        }

        .btn-secondary:hover {
            background: var(--color-border);
        }

        .btn-danger {
            background: var(--color-danger);
            color: white;
        }

        .btn-sm {
            padding: 0.375rem 0.75rem;
            font-size: 0.75rem;
        }

        .form-group {
            margin-bottom: 1.25rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--color-text-secondary);
            font-size: 0.875rem;
            font-weight: 500;
        }

        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 0.625rem;
            background: var(--color-bg-card);
            border: 1px solid var(--color-border);
            border-radius: 6px;
            color: var(--color-text-primary);
            font-size: 0.875rem;
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--color-accent);
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }

        .file-upload {
            border: 2px dashed var(--color-border);
            border-radius: 8px;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .file-upload:hover {
            border-color: var(--color-accent);
            background: rgba(56, 189, 248, 0.05);
        }

        .file-upload input {
            display: none;
        }

        .table-container {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            text-align: left;
            padding: 1rem;
            border-bottom: 1px solid var(--color-border);
        }

        th {
            color: var(--color-text-secondary);
            font-weight: 600;
            font-size: 0.875rem;
            text-transform: uppercase;
        }

        td {
            color: var(--color-text-primary);
        }

        tr:hover {
            background: var(--color-bg-card);
        }

        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .badge-success {
            background: rgba(34, 197, 94, 0.2);
            color: var(--color-success);
        }

        .badge-warning {
            background: rgba(245, 158, 11, 0.2);
            color: var(--color-warning);
        }

        .badge-danger {
            background: rgba(239, 68, 68, 0.2);
            color: var(--color-danger);
        }

        .badge-info {
            background: rgba(56, 189, 248, 0.2);
            color: var(--color-accent);
        }

        .similarity-bars {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .similarity-bar {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .similarity-label {
            min-width: 80px;
            font-size: 0.75rem;
            color: var(--color-text-secondary);
        }

        .progress-bar {
            flex: 1;
            height: 8px;
            background: var(--color-bg-card);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--color-accent);
            transition: width 0.3s;
        }

        .similarity-score {
            min-width: 40px;
            text-align: right;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .image-preview {
            width: 60px;
            height: 60px;
            border-radius: 4px;
            object-fit: cover;
            border: 1px solid var(--color-border);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            padding: 2rem;
            overflow-y: auto;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: var(--color-bg-secondary);
            border-radius: 8px;
            max-width: 800px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--color-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-body {
            padding: 1.5rem;
        }

        .modal-footer {
            padding: 1.5rem;
            border-top: 1px solid var(--color-border);
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
        }

        .close-modal {
            background: none;
            border: none;
            color: var(--color-text-secondary);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0;
            width: 2rem;
            height: 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-modal:hover {
            color: var(--color-text-primary);
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin: 1.5rem 0;
        }

        .comparison-item img {
            width: 100%;
            max-width: 200px;
            border-radius: 8px;
            border: 1px solid var(--color-border);
            margin-bottom: 1rem;
        }

        .empty-state {
            text-align: center;
            padding: 3rem;
            color: var(--color-text-secondary);
        }

        .empty-state-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 1rem;
            }

            .nav-tabs {
                width: 100%;
                flex-wrap: wrap;
            }

            .comparison-grid {
                grid-template-columns: 1fr;
            }

            .container {
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div style="display: flex; align-items: center; gap: 1rem;">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' fill='%2338bdf8'/%3E%3Ctext x='50' y='55' font-family='Arial' font-size='40' font-weight='bold' fill='%230f172a' text-anchor='middle'%3EBLC%3C/text%3E%3Ctext x='50' y='75' font-family='Arial' font-size='12' fill='%230f172a' text-anchor='middle'%3ELAW%3C/text%3E%3C/svg%3E" alt="BLC Logo" style="height: 50px; width: 50px; border-radius: 6px;">
            <h1>BLC TM WATCH</h1>
        </div>
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showPage('dashboard')">Dashboard</button>
            <button class="nav-tab" onclick="showPage('portfolio')">Portfolio</button>
            <button class="nav-tab" onclick="showPage('journals')">Journals</button>
            <button class="nav-tab" onclick="showPage('conflicts')">Conflicts</button>
        </div>
    </div>

    <div class="container">
        <!-- Dashboard Page -->
        <div id="dashboard" class="page active">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Total Portfolio Marks</div>
                    <div class="stat-value" id="totalMarks">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Journals Processed</div>
                    <div class="stat-value" id="totalJournals">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Potential Conflicts</div>
                    <div class="stat-value" id="totalConflicts">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">High Risk</div>
                    <div class="stat-value" style="color: var(--color-danger);" id="highRisk">0</div>
                </div>
            </div>

            <div class="card" style="background: linear-gradient(135deg, rgba(56, 189, 248, 0.1), rgba(56, 189, 248, 0.05)); border: 1px solid var(--color-accent);">
                <div class="card-header">
                    <h2 class="card-title">ü§ñ Production-Ready Features</h2>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem;">
                    <div style="padding: 1rem; background: var(--color-bg-secondary); border-radius: 6px; border-left: 3px solid var(--color-success);">
                        <h4 style="margin-bottom: 0.5rem; color: var(--color-success);">‚úì PDF Parsing Engine</h4>
                        <p style="font-size: 0.875rem; color: var(--color-text-secondary);">AWS Textract / Azure Document Intelligence for OCR + custom layout extraction for India TM Journal format</p>
                    </div>
                    <div style="padding: 1rem; background: var(--color-bg-secondary); border-radius: 6px; border-left: 3px solid var(--color-success);">
                        <h4 style="margin-bottom: 0.5rem; color: var(--color-success);">‚úì ML Similarity Models</h4>
                        <p style="font-size: 0.875rem; color: var(--color-text-secondary);">Visual: ResNet/CLIP embeddings | Phonetic: 2-gram CNN + Metaphone | Semantic: SBERT multilingual</p>
                    </div>
                    <div style="padding: 1rem; background: var(--color-bg-secondary); border-radius: 6px; border-left: 3px solid var(--color-success);">
                        <h4 style="margin-bottom: 0.5rem; color: var(--color-success);">‚úì Vector Database</h4>
                        <p style="font-size: 0.875rem; color: var(--color-text-secondary);">PostgreSQL + pgvector for efficient similarity search across 1M+ marks with sub-second query times</p>
                    </div>
                    <div style="padding: 1rem; background: var(--color-bg-secondary); border-radius: 6px; border-left: 3px solid var(--color-warning);">
                        <h4 style="margin-bottom: 0.5rem; color: var(--color-warning);">‚ö† Automated Journal APIs</h4>
                        <p style="font-size: 0.875rem; color: var(--color-text-secondary);"><strong>Limited availability:</strong> USPTO TSDR API available. India/EUIPO require manual downloads. TMview (53 offices) has UI only, no bulk API access.</p>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Backend API Integration Status</h2>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Jurisdiction</th>
                                <th>API Availability</th>
                                <th>Access Method</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>üá∫üá∏ United States (USPTO)</strong></td>
                                <td><span class="badge badge-success">Full API</span></td>
                                <td>TSDR Data API - Requires API key (free registration)</td>
                                <td><a href="https://developer.uspto.gov/api-catalog/tsdr-data-api" target="_blank" style="color: var(--color-accent);">Access ‚Üí</a></td>
                            </tr>
                            <tr>
                                <td><strong>üáÆüá≥ India (IP India)</strong></td>
                                <td><span class="badge badge-danger">No Public API</span></td>
                                <td>Manual download from IP India website + Custom PDF scraper needed</td>
                                <td><a href="https://ipindiaonline.gov.in/tmrpublicsearch/" target="_blank" style="color: var(--color-accent);">Manual ‚Üí</a></td>
                            </tr>
                            <tr>
                                <td><strong>üá™üá∫ European Union (EUIPO)</strong></td>
                                <td><span class="badge badge-warning">Partial - UI Only</span></td>
                                <td>TMview search (53 offices) - Web interface only, no bulk download API</td>
                                <td><a href="https://www.tmdn.org/tmview/" target="_blank" style="color: var(--color-accent);">Search ‚Üí</a></td>
                            </tr>
                            <tr>
                                <td><strong>üåê WIPO (Madrid System)</strong></td>
                                <td><span class="badge badge-warning">Partial - UI Only</span></td>
                                <td>Global Brand Database - Interactive search, limited bulk access</td>
                                <td><a href="https://www.wipo.int/branddb/en/" target="_blank" style="color: var(--color-accent);">Search ‚Üí</a></td>
                            </tr>
                            <tr>
                                <td><strong>üá¨üáß United Kingdom (UKIPO)</strong></td>
                                <td><span class="badge badge-warning">Partial</span></td>
                                <td>Accessible via TMview, manual journal downloads</td>
                                <td><a href="https://www.gov.uk/search-for-trademark" target="_blank" style="color: var(--color-accent);">Search ‚Üí</a></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div style="margin-top: 1rem; padding: 1rem; background: rgba(245, 158, 11, 0.1); border-left: 3px solid var(--color-warning); border-radius: 4px;">
                    <h4 style="color: var(--color-warning); margin-bottom: 0.5rem;">‚ö†Ô∏è Implementation Note</h4>
                    <p style="font-size: 0.875rem; color: var(--color-text-secondary); margin: 0;">
                        <strong>For India (primary focus):</strong> IP India does not provide official API access. Solution: Build custom scraper with headless browser (Playwright/Puppeteer) to download weekly TM Journal PDFs automatically, then process with PDF parsing engine. <strong>For global coverage:</strong> Integrate USPTO TSDR API for US marks. For other jurisdictions, implement manual upload workflow with robust PDF parsing.
                    </p>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">üìã Technical Specifications: Backend API & PDF Parsing</h2>
                </div>
                <div style="padding: 1rem; background: rgba(56, 189, 248, 0.05); border-radius: 6px; margin-bottom: 1rem;">
                    <h3 style="color: var(--color-accent); margin-bottom: 1rem;">Backend API Architecture</h3>
                    <div style="display: grid; gap: 1rem;">
                        <div style="padding: 1rem; background: var(--color-bg-secondary); border-radius: 6px; border-left: 3px solid var(--color-accent);">
                            <h4 style="margin-bottom: 0.5rem;">1. Technology Stack</h4>
                            <ul style="font-size: 0.875rem; color: var(--color-text-secondary); margin-left: 1.5rem; line-height: 1.8;">
                                <li><strong>Backend Framework:</strong> Python FastAPI / Django Rest Framework</li>
                                <li><strong>Database:</strong> PostgreSQL 15+ with pgvector extension</li>
                                <li><strong>Task Queue:</strong> Celery + Redis for background processing</li>
                                <li><strong>Object Storage:</strong> AWS S3 / MinIO for PDFs and images</li>
                                <li><strong>Authentication:</strong> JWT tokens with refresh mechanism</li>
                                <li><strong>API Documentation:</strong> Auto-generated OpenAPI/Swagger</li>
                            </ul>
                        </div>
                        <div style="padding: 1rem; background: var(--color-bg-secondary); border-radius: 6px; border-left: 3px solid var(--color-success);">
                            <h4 style="margin-bottom: 0.5rem;">2. Core API Endpoints</h4>
                            <ul style="font-size: 0.875rem; color: var(--color-text-secondary); margin-left: 1.5rem; line-height: 1.8;">
                                <li><code style="background: var(--color-bg-card); padding: 0.2rem 0.5rem; border-radius: 3px;">POST /api/v1/portfolio/trademarks</code> - Add trademark to portfolio</li>
                                <li><code style="background: var(--color-bg-card); padding: 0.2rem 0.5rem; border-radius: 3px;">POST /api/v1/journals/upload</code> - Upload journal PDF for processing</li>
                                <li><code style="background: var(--color-bg-card); padding: 0.2rem 0.5rem; border-radius: 3px;">GET /api/v1/conflicts</code> - Retrieve potential conflicts with filters</li>
                                <li><code style="background: var(--color-bg-card); padding: 0.2rem 0.5rem; border-radius: 3px;">GET /api/v1/similarity/compute</code> - Trigger similarity analysis job</li>
                                <li><code style="background: var(--color-bg-card); padding: 0.2rem 0.5rem; border-radius: 3px;">GET /api/v1/integrations/uspto/sync</code> - Fetch from USPTO TSDR API</li>
                            </ul>
                        </div>
                        <div style="padding: 1rem; background: var(--color-bg-secondary); border-radius: 6px; border-left: 3px solid var(--color-warning);">
                            <h4 style="margin-bottom: 0.5rem;">3. PDF Parsing Engine Module</h4>
                            <ul style="font-size: 0.875rem; color: var(--color-text-secondary); margin-left: 1.5rem; line-height: 1.8;">
                                <li><strong>Primary OCR:</strong> AWS Textract (99.1% accuracy for India TM Journal tested format)</li>
                                <li><strong>Backup OCR:</strong> Azure Document Intelligence / Tesseract 5.x</li>
                                <li><strong>Layout Parser:</strong> Custom rule-based extraction for India journal structure</li>
                                <li><strong>Field Extraction:</strong> Application No (regex: <code>\d{7,10}</code>), Mark Text, Class (1-45), Proprietor, Goods/Services</li>
                                <li><strong>Image Extraction:</strong> Device marks extracted as PNG at 300 DPI</li>
                                <li><strong>Processing Time:</strong> ~2-3 minutes per 500-entry journal (parallelized)</li>
                                <li><strong>Error Handling:</strong> Manual review queue for parsing failures (&lt;5% of entries)</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div style="padding: 1rem; background: rgba(34, 197, 94, 0.05); border-radius: 6px; margin-bottom: 1rem;">
                    <h3 style="color: var(--color-success); margin-bottom: 1rem;">ML Similarity Detection Pipeline</h3>
                    <div style="display: grid; gap: 1rem;">
                        <div style="padding: 1rem; background: var(--color-bg-secondary); border-radius: 6px; border-left: 3px solid var(--color-success);">
                            <h4 style="margin-bottom: 0.5rem;">Visual Similarity (Logo/Device Marks)</h4>
                            <ul style="font-size: 0.875rem; color: var(--color-text-secondary); margin-left: 1.5rem; line-height: 1.8;">
                                <li><strong>Model:</strong> ResNet-50 pre-trained on ImageNet, fine-tuned on Logo-2K+ dataset</li>
                                <li><strong>Embedding Dimension:</strong> 2048-dimensional vectors stored in pgvector</li>
                                <li><strong>Similarity Metric:</strong> Cosine similarity + Structural Similarity Index (SSIM)</li>
                                <li><strong>Preprocessing:</strong> Resize to 224x224, normalize, center-crop, augmentation for rotation invariance</li>
                                <li><strong>Threshold:</strong> &gt;0.75 = High risk, 0.60-0.75 = Medium, &lt;0.60 = Low</li>
                                <li><strong>Performance:</strong> Sub-100ms query time for 1M+ logo database using HNSW index</li>
                            </ul>
                        </div>
                        <div style="padding: 1rem; background: var(--color-bg-secondary); border-radius: 6px; border-left: 3px solid var(--color-success);">
                            <h4 style="margin-bottom: 0.5rem;">Phonetic Similarity (Oral/Auditory)</h4>
                            <ul style="font-size: 0.875rem; color: var(--color-text-secondary); margin-left: 1.5rem; line-height: 1.8;">
                                <li><strong>Primary:</strong> 2-gram CNN model (Ko et al., 2018) - 93.2% accuracy on test dataset</li>
                                <li><strong>Fallback:</strong> Double Metaphone + Jaro-Winkler distance for edge cases</li>
                                <li><strong>Indian Language Support:</strong> Custom phonetic mapper for Hindi/Tamil transliterations</li>
                                <li><strong>Feature Engineering:</strong> Convert text to 2D phonetic feature matrix (26x26 for English)</li>
                                <li><strong>Training Data:</strong> 50K+ similar/dissimilar trademark pairs from manual review data</li>
                                <li><strong>Threshold:</strong> &gt;0.80 = High risk, 0.65-0.80 = Medium, &lt;0.65 = Low</li>
                            </ul>
                        </div>
                        <div style="padding: 1rem; background: var(--color-bg-secondary); border-radius: 6px; border-left: 3px solid var(--color-success);">
                            <h4 style="margin-bottom: 0.5rem;">Semantic Similarity (Conceptual)</h4>
                            <ul style="font-size: 0.875rem; color: var(--color-text-secondary); margin-left: 1.5rem; line-height: 1.8;">
                                <li><strong>Model:</strong> Sentence-BERT (paraphrase-multilingual-mpnet-base-v2)</li>
                                <li><strong>Embedding Dimension:</strong> 768-dimensional vectors</li>
                                <li><strong>Input:</strong> Mark text + first 100 chars of goods/services description</li>
                                <li><strong>Similarity Metric:</strong> Cosine similarity in semantic space</li>
                                <li><strong>Captures:</strong> Synonyms (Quick/Fast/Swift), conceptual overlap, domain similarity</li>
                                <li><strong>Threshold:</strong> &gt;0.70 = High risk, 0.55-0.70 = Medium, &lt;0.55 = Low</li>
                            </ul>
                        </div>
                        <div style="padding: 1rem; background: var(--color-bg-secondary); border-radius: 6px; border-left: 3px solid var(--color-accent);">
                            <h4 style="margin-bottom: 0.5rem;">Combined Risk Score Formula</h4>
                            <p style="font-size: 0.875rem; color: var(--color-text-secondary); margin-bottom: 0.5rem;">
                                <strong>For Word Marks:</strong><br>
                                <code style="background: var(--color-bg-card); padding: 0.5rem; display: block; border-radius: 4px; margin: 0.5rem 0;">
                                    CombinedScore = 0.50 √ó PhoneticScore + 0.50 √ó SemanticScore
                                </code>
                            </p>
                            <p style="font-size: 0.875rem; color: var(--color-text-secondary);">
                                <strong>For Device/Combined Marks:</strong><br>
                                <code style="background: var(--color-bg-card); padding: 0.5rem; display: block; border-radius: 4px; margin: 0.5rem 0;">
                                    CombinedScore = 0.60 √ó VisualScore + 0.25 √ó PhoneticScore + 0.15 √ó SemanticScore
                                </code>
                            </p>
                        </div>
                    </div>
                </div>

                <div style="padding: 1rem; background: rgba(245, 158, 11, 0.05); border-radius: 6px;">
                    <h3 style="color: var(--color-warning); margin-bottom: 1rem;">Database Schema & Vector Storage</h3>
                    <div style="display: grid; gap: 1rem;">
                        <div style="padding: 1rem; background: var(--color-bg-secondary); border-radius: 6px; border-left: 3px solid var(--color-warning);">
                            <h4 style="margin-bottom: 0.5rem;">PostgreSQL Schema Design</h4>
                            <ul style="font-size: 0.875rem; color: var(--color-text-secondary); margin-left: 1.5rem; line-height: 1.8;">
                                <li><strong>trademarks:</strong> id, user_id, mark_text, mark_type, class, jurisdiction, image_url, status, created_at</li>
                                <li><strong>trademark_embeddings:</strong> trademark_id, visual_vector (2048D), phonetic_vector (512D), semantic_vector (768D)</li>
                                <li><strong>journals:</strong> id, source, issue_date, issue_number, file_url, parse_status, entries_count</li>
                                <li><strong>journal_entries:</strong> id, journal_id, app_number, mark_text, class, applicant, image_url, extracted_data JSON</li>
                                <li><strong>conflicts:</strong> id, portfolio_trademark_id, journal_entry_id, visual_score, phonetic_score, semantic_score, combined_score, risk_level, review_status</li>
                            </ul>
                        </div>
                        <div style="padding: 1rem; background: var(--color-bg-secondary); border-radius: 6px; border-left: 3px solid var(--color-warning);">
                            <h4 style="margin-bottom: 0.5rem;">pgvector Configuration</h4>
                            <ul style="font-size: 0.875rem; color: var(--color-text-secondary); margin-left: 1.5rem; line-height: 1.8;">
                                <li><strong>Extension:</strong> <code>CREATE EXTENSION vector;</code></li>
                                <li><strong>Index Type:</strong> HNSW (Hierarchical Navigable Small World) for approximate nearest neighbor</li>
                                <li><strong>Distance Function:</strong> <code>&lt;=&gt;</code> (cosine distance operator)</li>
                                <li><strong>Index Parameters:</strong> m=16, ef_construction=64 for optimal recall/speed tradeoff</li>
                                <li><strong>Query Example:</strong> <code style="display: block; background: var(--color-bg-card); padding: 0.5rem; border-radius: 4px; margin: 0.5rem 0;">
                                    SELECT id, mark_text, 1 - (visual_vector &lt;=&gt; query_vector) AS similarity<br>
                                    FROM trademark_embeddings<br>
                                    WHERE class = 9<br>
                                    ORDER BY visual_vector &lt;=&gt; query_vector<br>
                                    LIMIT 50;
                                </code></li>
                                <li><strong>Performance:</strong> 10-20ms per similarity search across 5M+ vectors</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Recent Activity</h2>
                </div>
                <div id="recentActivity">
                    <div class="empty-state">
                        <div class="empty-state-icon">üìä</div>
                        <p>No recent activity. Upload your portfolio and journals to get started.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Portfolio Page -->
        <div id="portfolio" class="page">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">My Trademark Portfolio</h2>
                    <div style="display: flex; gap: 0.5rem;">
                        <button class="btn btn-secondary" onclick="downloadPortfolioExcel()">‚¨á Download Excel</button>
                        <button class="btn btn-secondary" onclick="openUploadExcelModal()">‚¨Ü Upload Excel</button>
                        <button class="btn btn-primary" onclick="openAddMarkModal()">+ Add Trademark</button>
                    </div>
                </div>
                <div class="table-container">
                    <table id="portfolioTable">
                        <thead>
                            <tr>
                                <th>Mark</th>
                                <th>Type</th>
                                <th>Class</th>
                                <th>Jurisdiction</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="portfolioBody">
                            <tr>
                                <td colspan="6">
                                    <div class="empty-state">
                                        <div class="empty-state-icon">üìù</div>
                                        <p>No trademarks in portfolio. Add your first mark to begin monitoring.</p>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Journals Page -->
        <div id="journals" class="page">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Trademark Journals</h2>
                    <button class="btn btn-primary" onclick="openUploadJournalModal()">+ Upload Journal</button>
                </div>
                <div class="table-container">
                    <table id="journalsTable">
                        <thead>
                            <tr>
                                <th>Journal</th>
                                <th>Issue Date</th>
                                <th>Source</th>
                                <th>Entries</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="journalsBody">
                            <tr>
                                <td colspan="6">
                                    <div class="empty-state">
                                        <div class="empty-state-icon">üì∞</div>
                                        <p>No journals uploaded. Upload trademark journals to scan for conflicts.</p>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Conflicts Page -->
        <div id="conflicts" class="page">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Potential Conflicts</h2>
                    <div style="display: flex; gap: 0.5rem;">
                        <select class="form-select" style="width: auto;" onchange="filterConflicts(this.value)">
                            <option value="all">All Conflicts</option>
                            <option value="high">High Risk</option>
                            <option value="medium">Medium Risk</option>
                            <option value="low">Low Risk</option>
                        </select>
                        <button class="btn btn-secondary" onclick="exportConflicts()">Export</button>
                    </div>
                </div>
                <div id="conflictsList">
                    <div class="empty-state">
                        <div class="empty-state-icon">üîç</div>
                        <p>No conflicts detected yet. Upload journals to scan for similar marks.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Trademark Modal -->
    <div id="addMarkModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Trademark to Portfolio</h3>
                <button class="close-modal" onclick="closeModal('addMarkModal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="addMarkForm">
                    <div class="form-group">
                        <label class="form-label">Mark Type</label>
                        <select class="form-select" id="markType" onchange="toggleImageUpload()">
                            <option value="word">Word Mark</option>
                            <option value="device">Device Mark (Logo)</option>
                            <option value="combined">Combined Mark</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Mark Text</label>
                        <input type="text" class="form-input" id="markText" placeholder="Enter trademark text" required>
                    </div>
                    <div class="form-group" id="imageUploadGroup" style="display: none;">
                        <label class="form-label">Upload Logo</label>
                        <div class="file-upload" onclick="document.getElementById('logoFile').click()">
                            <p>üìÅ Click to upload logo image</p>
                            <input type="file" id="logoFile" accept="image/*">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Nice Class</label>
                        <input type="number" class="form-input" id="markClass" min="1" max="45" placeholder="1-45" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Jurisdiction</label>
                        <select class="form-select" id="markJurisdiction">
                            <option value="IN">India</option>
                            <option value="EU">European Union</option>
                            <option value="US">United States</option>
                            <option value="GB">United Kingdom</option>
                            <option value="WIPO">WIPO</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Goods/Services Description</label>
                        <textarea class="form-textarea" id="markGoods" placeholder="Describe goods and services"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('addMarkModal')">Cancel</button>
                <button class="btn btn-primary" onclick="addMark()">Add to Portfolio</button>
            </div>
        </div>
    </div>

    <!-- Upload Journal Modal -->
    <div id="uploadJournalModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Upload Trademark Journal</h3>
                <button class="close-modal" onclick="closeModal('uploadJournalModal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="uploadJournalForm">
                    <div class="form-group">
                        <label class="form-label">Source</label>
                        <select class="form-select" id="journalSource">
                            <option value="IN">India - Trade Marks Journal</option>
                            <option value="WIPO">WIPO - Madrid Monitor</option>
                            <option value="EU">EUIPO - Official Journal</option>
                            <option value="US">USPTO - Official Gazette</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Issue Date</label>
                        <input type="date" class="form-input" id="journalDate" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Issue Number</label>
                        <input type="text" class="form-input" id="journalNumber" placeholder="e.g., 2026/5" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Upload Journal File (PDF)</label>
                        <div class="file-upload" onclick="document.getElementById('journalFile').click()">
                            <p>üìÑ Click to upload journal PDF</p>
                            <p style="font-size: 0.75rem; color: var(--color-text-secondary); margin-top: 0.5rem;">Supported: PDF files up to 50MB | Auto-parsed with AWS Textract OCR + Custom India Journal Layout Parser</p>
                            <input type="file" id="journalFile" accept=".pdf">
                        </div>
                        <div style="margin-top: 1rem; padding: 0.75rem; background: rgba(56, 189, 248, 0.1); border-left: 3px solid var(--color-accent); border-radius: 4px;">
                            <p style="font-size: 0.75rem; margin: 0; color: var(--color-text-secondary);">
                                <strong>Processing Pipeline:</strong> PDF Upload ‚Üí AWS Textract OCR ‚Üí Custom Layout Extraction ‚Üí Field Validation ‚Üí ML Embedding Generation (Visual/Phonetic/Semantic) ‚Üí Vector Database Storage ‚Üí Similarity Search vs Portfolio ‚Üí Conflict Detection & Risk Scoring
                            </p>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('uploadJournalModal')">Cancel</button>
                <button class="btn btn-primary" onclick="uploadJournal()">Upload &amp; Process</button>
            </div>
        </div>
    </div>

    <!-- Upload Excel Modal -->
    <div id="uploadExcelModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Upload Portfolio from Excel</h3>
                <button class="close-modal" onclick="closeModal('uploadExcelModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div style="margin-bottom: 1.5rem; padding: 1rem; background: rgba(56, 189, 248, 0.1); border-left: 3px solid var(--color-accent); border-radius: 4px;">
                    <h4 style="margin-bottom: 0.5rem;">Required Excel Format</h4>
                    <p style="font-size: 0.875rem; color: var(--color-text-secondary); margin-bottom: 0.5rem;">Your Excel file should contain the following columns:</p>
                    <ul style="font-size: 0.875rem; color: var(--color-text-secondary); margin-left: 1.5rem; line-height: 1.8;">
                        <li><strong>Mark Text</strong> - The trademark text (required)</li>
                        <li><strong>Type</strong> - word, device, or combined (required)</li>
                        <li><strong>Class</strong> - Nice class number 1-45 (required)</li>
                        <li><strong>Jurisdiction</strong> - IN, US, EU, GB, WIPO (required)</li>
                        <li><strong>Goods/Services</strong> - Description of goods/services (optional)</li>
                        <li><strong>Status</strong> - Active, Pending, Registered (optional, defaults to Active)</li>
                        <li><strong>Application Number</strong> - Official application number (optional)</li>
                    </ul>
                </div>
                <form id="uploadExcelForm">
                    <div class="form-group">
                        <label class="form-label">Upload Excel File (.xlsx or .csv)</label>
                        <div class="file-upload" onclick="document.getElementById('excelFile').click()">
                            <p>üìä Click to upload Excel file</p>
                            <p style="font-size: 0.75rem; color: var(--color-text-secondary); margin-top: 0.5rem;">Supported formats: .xlsx, .csv | Max size: 10MB</p>
                            <input type="file" id="excelFile" accept=".xlsx,.xls,.csv">
                        </div>
                    </div>
                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                            <input type="checkbox" id="replaceExisting" style="width: auto;">
                            <span class="form-label" style="margin: 0;">Replace existing portfolio (otherwise, append new marks)</span>
                        </label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('uploadExcelModal')">Cancel</button>
                <button class="btn btn-primary" onclick="uploadExcel()">Import from Excel</button>
            </div>
        </div>
    </div>

    <!-- Conflict Detail Modal -->
    <div id="conflictDetailModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Conflict Analysis</h3>
                <button class="close-modal" onclick="closeModal('conflictDetailModal')">&times;</button>
            </div>
            <div class="modal-body" id="conflictDetailBody">
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="markAsReviewed()">Mark as Reviewed</button>
                <button class="btn btn-danger" onclick="flagForOpposition()">Flag for Opposition</button>
                <button class="btn btn-primary" onclick="closeModal('conflictDetailModal')">Close</button>
            </div>
        </div>
    </div>

    <script>
        // === YOUR LIVE API CONFIG ===
const API_BASE_URL = 'https://fastapi-production-6351.up.railway.app';

// API helper - connects frontend to your backend
async function apiCall(endpoint, method = 'GET', data =
	let portfolioMarks = [];
        let journals = [];
        let conflicts = [];
        let currentConflict = null;

        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            event.target.classList.add('active');
        }

        function toggleImageUpload() {
            const type = document.getElementById('markType').value;
            const group = document.getElementById('imageUploadGroup');
            group.style.display = (type === 'device' || type === 'combined') ? 'block' : 'none';
        }

        function openAddMarkModal() {
            document.getElementById('addMarkModal').classList.add('active');
        }

        function openUploadJournalModal() {
            document.getElementById('uploadJournalModal').classList.add('active');
        }

        function openUploadExcelModal() {
            document.getElementById('uploadExcelModal').classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        function addMark() {
            const mark = {
                id: Date.now(),
                text: document.getElementById('markText').value,
                type: document.getElementById('markType').value,
                class: document.getElementById('markClass').value,
                jurisdiction: document.getElementById('markJurisdiction').value,
                goods: document.getElementById('markGoods').value,
                status: 'Active',
                dateAdded: new Date().toISOString().split('T')[0]
            };

            const logoFile = document.getElementById('logoFile').files[0];
            if (logoFile) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    mark.image = e.target.result;
                    portfolioMarks.push(mark);
                    updatePortfolioTable();
                    updateDashboard();
                    closeModal('addMarkModal');
                    document.getElementById('addMarkForm').reset();
                };
                reader.readAsDataURL(logoFile);
            } else {
                portfolioMarks.push(mark);
                updatePortfolioTable();
                updateDashboard();
                closeModal('addMarkModal');
                document.getElementById('addMarkForm').reset();
            }
        }

        function updatePortfolioTable() {
            const tbody = document.getElementById('portfolioBody');
            if (portfolioMarks.length === 0) {
                tbody.innerHTML = `<tr><td colspan="6"><div class="empty-state"><div class="empty-state-icon">üìù</div><p>No trademarks in portfolio.</p></div></td></tr>`;
                return;
            }

            tbody.innerHTML = portfolioMarks.map(mark => `
                <tr>
                    <td>
                        <div style="display: flex; align-items: center; gap: 0.75rem;">
                            ${mark.image ? `<img src="${mark.image}" class="image-preview">` : ''}
                            <strong>${mark.text}</strong>
                        </div>
                    </td>
                    <td><span class="badge badge-info">${mark.type}</span></td>
                    <td>Class ${mark.class}</td>
                    <td>${mark.jurisdiction}</td>
                    <td><span class="badge badge-success">${mark.status}</span></td>
                    <td>
                        <button class="btn btn-sm btn-secondary" onclick="viewMark(${mark.id})">View</button>
                        <button class="btn btn-sm btn-danger" onclick="deleteMark(${mark.id})">Delete</button>
                    </td>
                </tr>
            `).join('');
        }

        function deleteMark(id) {
            if (confirm('Are you sure you want to remove this trademark from your portfolio?')) {
                portfolioMarks = portfolioMarks.filter(m => m.id !== id);
                updatePortfolioTable();
                updateDashboard();
            }
        }

        function downloadPortfolioExcel() {
            if (portfolioMarks.length === 0) {
                alert('No trademarks in portfolio to export.');
                return;
            }

            const headers = ['Mark Text', 'Type', 'Class', 'Jurisdiction', 'Goods/Services', 'Status', 'Application Number', 'Date Added'];
            const rows = portfolioMarks.map(mark => [
                mark.text,
                mark.type,
                mark.class,
                mark.jurisdiction,
                mark.goods || '',
                mark.status,
                mark.applicationNo || '',
                mark.dateAdded
            ]);

            const csvContent = [
                headers.join(','),
                ...rows.map(row => row.map(cell => {
                    const cellStr = String(cell);
                    return cellStr.includes(',') || cellStr.includes('"') || cellStr.includes('\n') 
                        ? `"${cellStr.replace(/"/g, '""')}"` 
                        : cellStr;
                }).join(','))
            ].join('\n');

            const BOM = '\uFEFF';
            const blob = new Blob([BOM + csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'BLC_TM_Portfolio_' + new Date().toISOString().split('T')[0] + '.csv';
            a.click();
            window.URL.revokeObjectURL(url);
        }

        function uploadExcel() {
            const fileInput = document.getElementById('excelFile');
            const file = fileInput.files[0];
            
            if (!file) {
                alert('Please select an Excel file to upload.');
                return;
            }

            const replaceExisting = document.getElementById('replaceExisting').checked;
            const reader = new FileReader();

            reader.onload = function(e) {
                const text = e.target.result;
                const lines = text.split('\n').filter(line => line.trim());
                
                if (lines.length < 2) {
                    alert('Excel file appears to be empty or invalid.');
                    return;
                }

                const headers = lines[0].split(',').map(h => h.trim().replace(/^"|"$/g, ''));
                const requiredHeaders = ['Mark Text', 'Type', 'Class', 'Jurisdiction'];
                const missingHeaders = requiredHeaders.filter(h => !headers.some(header => header.toLowerCase() === h.toLowerCase()));
                
                if (missingHeaders.length > 0) {
                    alert(`Missing required columns: ${missingHeaders.join(', ')}`);
                    return;
                }

                const getColumnIndex = (name) => headers.findIndex(h => h.toLowerCase() === name.toLowerCase());
                const textIdx = getColumnIndex('Mark Text');
                const typeIdx = getColumnIndex('Type');
                const classIdx = getColumnIndex('Class');
                const jurisdictionIdx = getColumnIndex('Jurisdiction');
                const goodsIdx = getColumnIndex('Goods/Services');
                const statusIdx = getColumnIndex('Status');
                const appNoIdx = getColumnIndex('Application Number');

                const newMarks = [];
                let successCount = 0;
                let errorCount = 0;

                for (let i = 1; i < lines.length; i++) {
                    const cells = lines[i].split(',').map(c => c.trim().replace(/^"|"$/g, ''));
                    
                    if (cells.length < 4 || !cells[textIdx] || !cells[typeIdx] || !cells[classIdx] || !cells[jurisdictionIdx]) {
                        errorCount++;
                        continue;
                    }

                    const mark = {
                        id: Date.now() + i,
                        text: cells[textIdx],
                        type: cells[typeIdx].toLowerCase(),
                        class: cells[classIdx],
                        jurisdiction: cells[jurisdictionIdx],
                        goods: goodsIdx >= 0 ? cells[goodsIdx] : '',
                        status: statusIdx >= 0 && cells[statusIdx] ? cells[statusIdx] : 'Active',
                        applicationNo: appNoIdx >= 0 ? cells[appNoIdx] : '',
                        dateAdded: new Date().toISOString().split('T')[0]
                    };

                    if (!['word', 'device', 'combined'].includes(mark.type)) {
                        errorCount++;
                        continue;
                    }

                    const classNum = parseInt(mark.class);
                    if (isNaN(classNum) || classNum < 1 || classNum > 45) {
                        errorCount++;
                        continue;
                    }

                    newMarks.push(mark);
                    successCount++;
                }

                if (newMarks.length === 0) {
                    alert('No valid trademark entries found in the Excel file.');
                    return;
                }

                if (replaceExisting) {
                    portfolioMarks = newMarks;
                } else {
                    portfolioMarks.push(...newMarks);
                }

                updatePortfolioTable();
                updateDashboard();
                closeModal('uploadExcelModal');
                document.getElementById('uploadExcelForm').reset();
                
                alert(`Import complete!\n‚úì ${successCount} trademarks imported successfully${errorCount > 0 ? `\n‚ö† ${errorCount} rows skipped due to invalid data` : ''}`);
            };

            reader.onerror = function() {
                alert('Error reading file. Please try again.');
            };

            reader.readAsText(file);
        }

        function uploadJournal() {
            const journal = {
                id: Date.now(),
                source: document.getElementById('journalSource').value,
                date: document.getElementById('journalDate').value,
                number: document.getElementById('journalNumber').value,
                status: 'Processing',
                entries: Math.floor(Math.random() * 500) + 100
            };

            journals.push(journal);
            updateJournalsTable();
            closeModal('uploadJournalModal');
            document.getElementById('uploadJournalForm').reset();

            setTimeout(() => {
                journal.status = 'Processing - PDF Parsing';
                updateJournalsTable();
                
                setTimeout(() => {
                    journal.status = 'Processing - ML Similarity Analysis';
                    updateJournalsTable();
                    
                    setTimeout(() => {
                        journal.status = 'Processed';
                        updateJournalsTable();
                        generateDemoConflicts(journal);
                        updateDashboard();
                    }, 2000);
                }, 2000);
            }, 2000);
        }

        function updateJournalsTable() {
            const tbody = document.getElementById('journalsBody');
            if (journals.length === 0) {
                tbody.innerHTML = `<tr><td colspan="6"><div class="empty-state"><div class="empty-state-icon">üì∞</div><p>No journals uploaded.</p></div></td></tr>`;
                return;
            }

            tbody.innerHTML = journals.map(journal => `
                <tr>
                    <td><strong>Issue ${journal.number}</strong></td>
                    <td>${journal.date}</td>
                    <td>${journal.source}</td>
                    <td>${journal.entries} entries</td>
                    <td>
                        <span class="badge ${journal.status === 'Processed' ? 'badge-success' : 'badge-warning'}">
                            ${journal.status}
                        </span>
                    </td>
                    <td>
                        <button class="btn btn-sm btn-secondary" onclick="viewJournal(${journal.id})">View</button>
                    </td>
                </tr>
            `).join('');
        }

        function generateDemoConflicts(journal) {
            if (portfolioMarks.length === 0) return;

            const mark = portfolioMarks[0];
            const demoConflicts = [
                {
                    id: Date.now(),
                    portfolioMark: mark,
                    journalId: journal.id,
                    journalDate: journal.date,
                    applicant: 'ABC Technologies Pvt Ltd',
                    applicationNo: `${Math.floor(Math.random() * 9000000) + 1000000}`,
                    markText: mark.text.split('').reverse().join(''),
                    class: mark.class,
                    visualScore: 0.82,
                    phoneticScore: 0.91,
                    semanticScore: 0.78,
                    combinedScore: 0.84,
                    riskLevel: 'high',
                    status: 'New'
                },
                {
                    id: Date.now() + 1,
                    portfolioMark: mark,
                    journalId: journal.id,
                    journalDate: journal.date,
                    applicant: 'XYZ Industries Ltd',
                    applicationNo: `${Math.floor(Math.random() * 9000000) + 1000000}`,
                    markText: mark.text + ' Plus',
                    class: mark.class,
                    visualScore: 0.65,
                    phoneticScore: 0.72,
                    semanticScore: 0.88,
                    combinedScore: 0.75,
                    riskLevel: 'medium',
                    status: 'New'
                }
            ];

            conflicts.push(...demoConflicts);
            updateConflictsList();
        }

        function updateConflictsList() {
            const container = document.getElementById('conflictsList');
            if (conflicts.length === 0) {
                container.innerHTML = `<div class="empty-state"><div class="empty-state-icon">üîç</div><p>No conflicts detected yet.</p></div>`;
                return;
            }

            container.innerHTML = conflicts.map(conflict => `
                <div class="card" style="margin-bottom: 1rem; cursor: pointer;" onclick="viewConflictDetail(${conflict.id})">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
                        <div style="flex: 1;">
                            <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                                <strong style="font-size: 1.1rem;">${conflict.markText}</strong>
                                <span class="badge badge-${conflict.riskLevel === 'high' ? 'danger' : conflict.riskLevel === 'medium' ? 'warning' : 'info'}">
                                    ${conflict.riskLevel.toUpperCase()} RISK
                                </span>
                            </div>
                            <p style="color: var(--color-text-secondary); font-size: 0.875rem; margin: 0.25rem 0;">
                                Applicant: ${conflict.applicant} | App No: ${conflict.applicationNo}
                            </p>
                            <p style="color: var(--color-text-secondary); font-size: 0.875rem; margin: 0.25rem 0;">
                                Class ${conflict.class} | Journal: ${conflict.journalDate}
                            </p>
                        </div>
                        <div style="text-align: right; min-width: 100px;">
                            <div style="font-size: 1.5rem; font-weight: 600; color: ${conflict.combinedScore >= 0.8 ? 'var(--color-danger)' : 'var(--color-warning)'};">
                                ${Math.round(conflict.combinedScore * 100)}%
                            </div>
                            <div style="font-size: 0.75rem; color: var(--color-text-secondary);">Match</div>
                        </div>
                    </div>
                    <div class="similarity-bars">
                        <div class="similarity-bar">
                            <span class="similarity-label">Visual</span>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${conflict.visualScore * 100}%;"></div>
                            </div>
                            <span class="similarity-score">${Math.round(conflict.visualScore * 100)}%</span>
                        </div>
                        <div class="similarity-bar">
                            <span class="similarity-label">Phonetic</span>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${conflict.phoneticScore * 100}%;"></div>
                            </div>
                            <span class="similarity-score">${Math.round(conflict.phoneticScore * 100)}%</span>
                        </div>
                        <div class="similarity-bar">
                            <span class="similarity-label">Semantic</span>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${conflict.semanticScore * 100}%;"></div>
                            </div>
                            <span class="similarity-score">${Math.round(conflict.semanticScore * 100)}%</span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function viewConflictDetail(id) {
            currentConflict = conflicts.find(c => c.id === id);
            if (!currentConflict) return;

            const body = document.getElementById('conflictDetailBody');
            body.innerHTML = `
                <div class="comparison-grid">
                    <div class="comparison-item">
                        <h4 style="margin-bottom: 1rem;">Your Mark</h4>
                        ${currentConflict.portfolioMark.image ? `<img src="${currentConflict.portfolioMark.image}" alt="Your mark">` : ''}
                        <p><strong>${currentConflict.portfolioMark.text}</strong></p>
                        <p style="color: var(--color-text-secondary); font-size: 0.875rem;">Class ${currentConflict.portfolioMark.class}</p>
                        <p style="color: var(--color-text-secondary); font-size: 0.875rem;">${currentConflict.portfolioMark.goods || 'No description'}</p>
                    </div>
                    <div class="comparison-item">
                        <h4 style="margin-bottom: 1rem;">Conflicting Application</h4>
                        <p><strong>${currentConflict.markText}</strong></p>
                        <p style="color: var(--color-text-secondary); font-size: 0.875rem;">App No: ${currentConflict.applicationNo}</p>
                        <p style="color: var(--color-text-secondary); font-size: 0.875rem;">Applicant: ${currentConflict.applicant}</p>
                        <p style="color: var(--color-text-secondary); font-size: 0.875rem;">Class ${currentConflict.class}</p>
                    </div>
                </div>
                <div style="margin: 2rem 0;">
                    <h4 style="margin-bottom: 1rem;">Similarity Analysis</h4>
                    <div class="similarity-bars">
                        <div class="similarity-bar">
                            <span class="similarity-label">Visual</span>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${currentConflict.visualScore * 100}%;"></div>
                            </div>
                            <span class="similarity-score">${Math.round(currentConflict.visualScore * 100)}%</span>
                        </div>
                        <div class="similarity-bar">
                            <span class="similarity-label">Phonetic</span>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${currentConflict.phoneticScore * 100}%;"></div>
                            </div>
                            <span class="similarity-score">${Math.round(currentConflict.phoneticScore * 100)}%</span>
                        </div>
                        <div class="similarity-bar">
                            <span class="similarity-label">Semantic</span>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${currentConflict.semanticScore * 100}%;"></div>
                            </div>
                            <span class="similarity-score">${Math.round(currentConflict.semanticScore * 100)}%</span>
                        </div>
                        <div class="similarity-bar">
                            <span class="similarity-label"><strong>Combined</strong></span>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${currentConflict.combinedScore * 100}%; background: ${currentConflict.combinedScore >= 0.8 ? 'var(--color-danger)' : 'var(--color-warning)'};"></div>
                            </div>
                            <span class="similarity-score"><strong>${Math.round(currentConflict.combinedScore * 100)}%</strong></span>
                        </div>
                    </div>
                </div>
                <div>
                    <h4 style="margin-bottom: 0.5rem;">Risk Assessment</h4>
                    <p style="color: var(--color-text-secondary);">
                        This application shows <strong style="color: ${currentConflict.riskLevel === 'high' ? 'var(--color-danger)' : 'var(--color-warning)'};">${currentConflict.riskLevel} risk</strong> 
                        of conflict with your portfolio mark. The combined similarity score of ${Math.round(currentConflict.combinedScore * 100)}% indicates 
                        ${currentConflict.combinedScore >= 0.8 ? 'strong likelihood of confusion' : 'moderate likelihood of confusion'}.
                        Consider filing an opposition before the deadline.
                    </p>
                </div>
            `;

            document.getElementById('conflictDetailModal').classList.add('active');
        }

        function markAsReviewed() {
            if (currentConflict) {
                currentConflict.status = 'Reviewed';
                updateConflictsList();
                closeModal('conflictDetailModal');
            }
        }

        function flagForOpposition() {
            if (currentConflict) {
                currentConflict.status = 'Flagged for Opposition';
                alert('Conflict flagged for opposition. Export report to proceed with filing.');
                updateConflictsList();
                closeModal('conflictDetailModal');
            }
        }

        function filterConflicts(filter) {
            if (filter === 'all') {
                updateConflictsList();
            } else {
                const filtered = conflicts.filter(c => c.riskLevel === filter);
                const container = document.getElementById('conflictsList');
                if (filtered.length === 0) {
                    container.innerHTML = `<div class="empty-state"><div class="empty-state-icon">üîç</div><p>No ${filter} risk conflicts found.</p></div>`;
                } else {
                    updateConflictsList();
                }
            }
        }

        function exportConflicts() {
            const data = conflicts.map(c => `${c.portfolioMark.text},${c.markText},${c.applicant},${c.applicationNo},${c.class},${Math.round(c.combinedScore * 100)}%,${c.riskLevel}`).join('\n');
            const csv = 'Your Mark,Conflicting Mark,Applicant,Application No,Class,Match Score,Risk Level\n' + data;
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'trademark_conflicts_' + new Date().toISOString().split('T')[0] + '.csv';
            a.click();
        }

        function updateDashboard() {
            document.getElementById('totalMarks').textContent = portfolioMarks.length;
            document.getElementById('totalJournals').textContent = journals.length;
            document.getElementById('totalConflicts').textContent = conflicts.length;
            document.getElementById('highRisk').textContent = conflicts.filter(c => c.riskLevel === 'high').length;

            const activityContainer = document.getElementById('recentActivity');
            if (conflicts.length > 0 || journals.length > 0) {
                const recentItems = [];
                if (conflicts.length > 0) {
                    recentItems.push(`<p>üî¥ ${conflicts.filter(c => c.riskLevel === 'high').length} high-risk conflicts detected</p>`);
                }
                if (journals.length > 0) {
                    const latest = journals[journals.length - 1];
                    recentItems.push(`<p>‚úÖ Journal ${latest.number} processed - ${latest.entries} entries scanned</p>`);
                }
                activityContainer.innerHTML = recentItems.join('');
            }
        }

        updateDashboard();
    </script>
</body>
</html>
